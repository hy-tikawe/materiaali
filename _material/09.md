---
title: 9. Käytettävyys
slug: osa9
sections:
- Ilmoitukset
- Käyttäjän ohjaaminen
- Viestin näyttäminen
- Saavutettavuus
---

<style>
img {
    border-style: solid;
    border-color: black;
    border-width: 1px;
    width: 80%;
    margin-top: 40px;
    margin-bottom: 40px;    
}
</style>

# 9. Käytettävyys

Sovelluksen toimivuuden ja turvallisuuden lisäksi on tärkeää, että sovellusta on mukavaa käyttää. Tähän kuuluu muun muassa seuraavia asioita:

* Sovellusta on helppo käyttää ja se toimii käyttäjän odottamalla tavalla.
* Sovellus ilmaisee selkeästi, että toiminto onnistui, tai näyttää ymmärrettävän virheilmoituksen.
* Käyttäjä pystyy liikkumaan sujuvasti sovelluksessa eikä joudu umpikujaan.
* Sovellus toimii eri selaimilla ja eri laitteissa ja olettaa mahdollisimman vähän käyttäjän ympäristöstä.

Verkossa on paljon sekä hyvin että huonosti toimivia sovelluksia. Hyvin toimivat sovellukset soveltuvat omien sovellusten esikuviksi, kun taas huonosti toimivat sovellukset muistuttavat, mitä ei kannata tehdä.

## Ilmoitukset

Tällä hetkellä sovelluksemme tapa ilmoittaa virheistä ei ole käyttäjälle mukava. Esimerkiksi kun käyttäjä lähettää profiilikuvan, virheet käsitellään näin:

{: .code-title }
app.py
```python
        file = request.files["image"]
        if not file.filename.endswith(".jpg"):
            return "VIRHE: väärä tiedostomuoto"

        image = file.read()
        if len(image) > 100 * 1024:
            return "VIRHE: liian suuri kuva"
```

Tarkastellaan tilannetta, jossa käyttäjä koettaa lähettää liian suuren tiedoston profiilikuvaksi:

![](../img/09-flash1.png)

Tämän seurauksena käyttäjä saa seuraavan virheilmoituksen:

![](../img/09-flash2.png)

Ei ole hyvä ratkaisu, että sovellus näyttää virheilmoituksen erillisellä sivulla, josta käyttäjän täytyy itse palata lähetyssivulle. Voimme parantaa asiaa seuraavasti:

{: .code-title }
app.py
```python
from flask import flash

...

        file = request.files["image"]
        if not file.filename.endswith(".jpg"):
            flash("VIRHE: Lähettämäsi tiedosto ei ole jpg-tiedosto")
            return redirect("/add_image")

        image = file.read()
        if len(image) > 100 * 1024:
            flash("VIRHE: Lähettämäsi tiedosto on liian suuri")
            return redirect("/add_image")
```

Nyt sovellus määrittelee virheilmoituksen Flaskin `flash`-funktiolla sekä ohjaa käyttäjän takaisin lähetyssivulle. Tällä sivulla edellisen sivupyynnön virheet saadaan kutsumalla funktiota `get_flashed_messages`:

{: .code-title }
add_image.html
```jinja
  {% raw %}{% for message in get_flashed_messages() %}
  <p>
    <b>{{ message }}</b>
  </p>
  {% endfor %}{% endraw %}
```

Nyt virhe näkyy käyttäjälle selkeästi mukavammalla tavalla:

![](../img/09-flash3.png)

Tämän lisäksi voimme näyttää myös ilmoituksen käyttäjäsivulla siinä tilanteessa, jossa kuvan lisääminen onnistuu:

{: .code-title }
app.py
```python
        user_id = session["user_id"]
        users.update_image(user_id, image)
        flash("Kuvan lisääminen onnistui")
        return redirect("/user/" + str(user_id))
```

Kuvan lisääminen voi näyttää seuraavalta:

![](../img/09-flash4.png)

## Käyttäjän ohjaaminen

## Viestin näyttäminen

## Saavutettavuus
